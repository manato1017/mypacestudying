<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MyPace Study</title>
    <link rel="stylesheet" href="https://manato1017.github.io/mypacestudying/style.css">
</head>
<body>

    <header>
        <h1>MyPace Study</h1>
    </header>

    <main>
        <!-- Timer Tab -->
        <section id="timer" class="tab-content active">
            <div class="card">
                <div class="timer-container">
                    <svg class="timer-ring" viewBox="0 0 256 256">
                        <circle class="circle-bg" r="110" cx="128" cy="128" />
                        <circle id="timer-progress" class="progress-ring__circle" r="110" cx="128" cy="128" />
                    </svg>
                    <div class="timer-info">
                        <div class="timer-display" id="timer-display">25:00</div>
                        <div id="timer-status" class="timer-status">Focus</div>
                    </div>
                </div>
                <div class="timer-controls">
                    <button id="timer-toggle" class="btn btn-primary">スタート</button>
                    <button id="timer-reset" class="btn btn-gray">リセット</button>
                </div>
                <div style="text-align: left; border-top: 1px solid #eee; padding-top: 1rem;">
                    <div class="switch-container">
                        <span class="switch-label">マナーモード (消音)</span>
                        <label class="switch">
                            <input type="checkbox" id="silent-mode-toggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-bottom: 0.5rem;">
                        <div>
                            <p style="font-size: 0.7rem; color: #666;">集中 (分)</p>
                            <input type="number" id="focus-input" class="input-field">
                        </div>
                        <div>
                            <p style="font-size: 0.7rem; color: #666;">休憩 (分)</p>
                            <input type="number" id="break-input" class="input-field">
                        </div>
                    </div>
                    <button onclick="applyTimerSettings()" style="width: 100%; background: #333; color: white; border: none; padding: 0.65rem; border-radius: 0.65rem; cursor: pointer; font-size: 0.85rem; font-weight: 600;">保存してリセット</button>
                </div>
            </div>
        </section>

        <!-- Flashcards Tab -->
        <section id="flashcards" class="tab-content">
            <div class="group-selector-area" id="group-tabs"></div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                <h2 style="font-size: 0.9rem; font-weight: 700;">カード管理</h2>
                <div style="display: flex; gap: 0.5rem;">
                    <button onclick="toggleGroupModal()" style="font-size: 0.7rem; background: #eee; border: none; padding: 0.3rem 0.6rem; border-radius: 0.5rem;">+ グループ</button>
                    <button onclick="toggleCardModal()" style="background: var(--primary); color: white; border: none; width: 1.8rem; height: 1.8rem; border-radius: 50%; font-size: 1.2rem;">+</button>
                </div>
            </div>
            <div id="card-display" class="flashcard-display">
                <div id="card-inner" class="flashcard-inner">
                    <p id="card-text" class="flashcard-text">カードなし</p>
                    <button id="delete-card-btn" onclick="deleteCurrentCard(event)" class="btn-delete-card">
                        <svg viewBox="0 0 20 20" fill="currentColor"><path d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z"/></svg>
                    </button>
                </div>
            </div>
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0 1.5rem;">
                <button onclick="prevCard()" style="background:none; border:none; color:var(--primary); font-size: 1.5rem; font-weight:700;">←</button>
                <span id="card-counter" style="font-size: 0.8rem; font-weight:600;">0 / 0</span>
                <button onclick="nextCard()" style="background:none; border:none; color:var(--primary); font-size: 1.5rem; font-weight:700;">→</button>
            </div>
        </section>

        <!-- Todo Tab -->
        <section id="todo" class="tab-content">
            <div class="card" style="text-align: left;">
                <h2 style="font-size: 1rem; font-weight: 700; margin-bottom: 0.75rem;">学習タスク</h2>
                <div style="background: var(--bg-gray); padding: 0.75rem; border-radius: 0.75rem; margin-bottom: 1rem;">
                    <input type="text" id="todo-input" class="input-field" style="margin-bottom:0.5rem;" placeholder="何をする？">
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <input type="date" id="todo-date-input" class="input-field" style="margin-bottom:0; flex:1;">
                        <button id="add-todo" style="background: var(--primary); color: white; border: none; padding: 0.5rem 1rem; border-radius: 0.6rem; font-size: 0.8rem; font-weight: 600;">追加</button>
                    </div>
                </div>
                <div style="font-size: 0.7rem; color: var(--text-light); text-transform: uppercase; margin-bottom: 0.4rem;">● 進行中</div>
                <div class="ongoing-tasks-container" id="ongoing-list"></div>
                <div style="font-size: 0.7rem; color: var(--text-light); text-transform: uppercase; margin: 1.5rem 0 0.4rem;">✓ 完了済み</div>
                <div class="completed-tasks-container" id="completed-list"></div>
            </div>
        </section>

        <!-- Statistics Tab -->
        <section id="stats" class="tab-content">
            <div class="stat-grid">
                <div class="stat-card">
                    <div id="stat-today" class="stat-value">0h 0m</div>
                    <div class="stat-label">今日の学習</div>
                </div>
                <div class="stat-card">
                    <div id="stat-total" class="stat-value">0h 0m</div>
                    <div class="stat-label">全期間合計</div>
                </div>
            </div>
            <div class="card" style="text-align: left;">
                <h2 style="font-size: 0.9rem; font-weight: 700; margin-bottom: 0.5rem;">直近7日間の学習時間</h2>
                <div id="chart-area" class="chart-container">
                    <!-- JSで描画 -->
                </div>
            </div>
            <div class="card" style="text-align: left;">
                <h2 style="font-size: 0.9rem; font-weight: 700; margin-bottom: 0.5rem;">最近の履歴</h2>
                <div id="history-list" style="max-height: 200px; overflow-y: auto;">
                    <!-- JSで描画 -->
                </div>
            </div>
        </section>
    </main>

    <!-- Navigation -->
    <nav class="bottom-nav">
        <button onclick="switchTab('timer')" id="nav-timer" class="nav-item active">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            <span>タイマー</span>
        </button>
        <button onclick="switchTab('flashcards')" id="nav-flashcards" class="nav-item">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" /></svg>
            <span>カード</span>
        </button>
        <button onclick="switchTab('todo')" id="nav-todo" class="nav-item">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" /></svg>
            <span>タスク</span>
        </button>
        <button onclick="switchTab('stats')" id="nav-stats" class="nav-item">
            <svg fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" /></svg>
            <span>統計</span>
        </button>
    </nav>

    <!-- Modals -->
    <div id="card-modal" class="modal-overlay">
        <div class="modal-content">
            <h3 style="margin-bottom:0.75rem; font-size:1rem;">カード追加</h3>
            <select id="card-group-select" class="input-field"></select>
            <textarea id="card-q" class="input-field" placeholder="問題" rows="2"></textarea>
            <textarea id="card-a" class="input-field" placeholder="答え" rows="2"></textarea>
            <div style="display:flex; justify-content:flex-end; gap:0.5rem;">
                <button onclick="toggleCardModal()" style="background:none; border:none; font-size:0.8rem;">閉じる</button>
                <button onclick="addCard()" style="background:var(--primary); color:white; border:none; padding:0.4rem 0.8rem; border-radius:0.5rem; font-size:0.8rem;">保存</button>
            </div>
        </div>
    </div>

    <div id="group-modal" class="modal-overlay">
        <div class="modal-content">
            <h3 style="margin-bottom:0.75rem; font-size:1rem;">グループ作成</h3>
            <input type="text" id="group-name-input" class="input-field" placeholder="グループ名">
            <div style="display:flex; justify-content:flex-end; gap:0.5rem;">
                <button onclick="toggleGroupModal()" style="background:none; border:none; font-size:0.8rem;">閉じる</button>
                <button onclick="addGroup()" style="background:var(--primary); color:white; border:none; padding:0.4rem 0.8rem; border-radius:0.5rem; font-size:0.8rem;">作成</button>
            </div>
        </div>
    </div>

    <script src="https://manato1017.github.io/mypacestudying/app.js">
    </script>
</body>
</html>
